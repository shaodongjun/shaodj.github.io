<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>ShaoDJ's blog</title><link href="https://shaodongjun.github.io/" rel="alternate"></link><link href="https://shaodongjun.github.io/feeds/all-zh-cn.atom.xml" rel="self"></link><id>https://shaodongjun.github.io/</id><updated>2025-01-31T18:00:00+08:00</updated><entry><title>使用 openpyxl 创建 Excel 文件</title><link href="https://shaodongjun.github.io/python-openpyxl.html" rel="alternate"></link><published>2025-01-31T18:00:00+08:00</published><updated>2025-01-31T18:00:00+08:00</updated><author><name>ShaoDJ</name></author><id>tag:shaodongjun.github.io,2025-01-31:/python-openpyxl.html</id><summary type="html">&lt;p&gt;代码示例展示了如何使用 &lt;code&gt;openpyxl&lt;/code&gt; 库从文本文件中读取数据并将其写入Excel文件。&lt;/p&gt;
&lt;h2&gt;可运行代码&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;openpyxl&lt;/span&gt;

&lt;span class="c1"&gt;# 创建一个新的工作簿&lt;/span&gt;
&lt;span class="n"&gt;wb&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;openpyxl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Workbook&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# 创建 …&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;代码示例展示了如何使用 &lt;code&gt;openpyxl&lt;/code&gt; 库从文本文件中读取数据并将其写入Excel文件。&lt;/p&gt;
&lt;h2&gt;可运行代码&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;openpyxl&lt;/span&gt;

&lt;span class="c1"&gt;# 创建一个新的工作簿&lt;/span&gt;
&lt;span class="n"&gt;wb&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;openpyxl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Workbook&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# 创建一个工作表并命名为 &amp;quot;人员名单&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;wt&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;wb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create_sheet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;人员名单&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# 从文本文件读取数据并写入工作表&lt;/span&gt;
&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;memo.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readlines&lt;/span&gt;&lt;span class="p"&gt;()):&lt;/span&gt;
        &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;  &lt;span class="c1"&gt;# Excel 行从 1 开始&lt;/span&gt;
        &lt;span class="n"&gt;people&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;,&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;people&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="c1"&gt;# 确保至少有两个元素&lt;/span&gt;
            &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;people&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="n"&gt;sex&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;people&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="n"&gt;wt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;column&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;wt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;column&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;sex&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;wb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;测试名单.xlsx&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2&gt;代码解释&lt;/h2&gt;
&lt;h3&gt;创建工作簿和工作表：&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;使用 openpyxl.Workbook() 创建一个新的工作簿。&lt;/li&gt;
&lt;li&gt;create_sheet("人员名单", 0) 创建一个新的工作表并将其命名为 "人员名单"。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;读取文件：&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;打开文本文件，确保使用正确的编码（如 UTF-8）。&lt;/li&gt;
&lt;li&gt;enumerate(f.readlines()) 用于逐行读取文件内容，并在循环中获得行索引。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;处理数据：&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;使用 strip().split(",") 去除行首尾空白并根据逗号分隔字符串。&lt;/li&gt;
&lt;li&gt;检查 people 列表的长度，确保至少有两个元素（姓名和性别）。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;写入工作表：&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;使用 wt.cell(row=row, column=1, value=name) 将姓名写入第一列，性别写入第二列。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;保存文件：&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;使用 wb.save("测试名单.xlsx") 保存工作簿。&lt;/li&gt;
&lt;li&gt;注意，openpyxl 支持 .xlsx 格式，而不是 .xls。&lt;/li&gt;
&lt;/ul&gt;</content><category term="编程"></category><category term="blog"></category><category term="python"></category></entry><entry><title>My first post</title><link href="https://shaodongjun.github.io/My-first-post.html" rel="alternate"></link><published>2025-01-31T12:00:00+08:00</published><updated>2025-01-31T12:00:00+08:00</updated><author><name>ShaoDJ</name></author><id>tag:shaodongjun.github.io,2025-01-31:/My-first-post.html</id><content type="html">&lt;h5&gt;开篇小记&lt;/h5&gt;
&lt;p&gt;This is the &lt;em&gt;first post&lt;/em&gt; by Pelican Blog. &lt;strong&gt;YAY!&lt;/strong&gt;&lt;/p&gt;</content><category term="杂记"></category><category term="blog"></category><category term="随笔"></category></entry></feed>